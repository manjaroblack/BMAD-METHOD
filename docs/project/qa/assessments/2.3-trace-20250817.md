# Requirements Traceability Matrix

## Story: 2.3 - Config Service and Open Core Config Command

### Coverage Summary

- Total Requirements: 4
- Fully Covered: 4 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: Config Service provides getCoreConfigPath() and openCoreConfig() with DI and error handling

Coverage: FULL

Given-When-Then Mappings:

- Unit Test: `tests/services/config_service_test.ts::ConfigService.getCoreConfigPath returns expected absolute path`
  - Given: Repo root path
  - When: Calling getCoreConfigPath()
  - Then: Returns absolute path to bmad-core/core-config.yaml
- Unit Test: `tests/services/config_service_test.ts::ConfigService.openCoreConfig success path resolves with code 0`
  - Given: Existing file and opener returns 0
  - When: Calling openCoreConfig()
  - Then: Resolves with code 0
- Unit Test: `tests/services/config_service_test.ts::... missing file rejects with actionable message`
  - Given: File does not exist
  - When: Calling openCoreConfig()
  - Then: Rejects with 'core-config.yaml not found'
- Unit Test: `tests/services/config_service_test.ts::... opener non-zero exit yields failure message`
  - Given: Opener returns non-zero
  - When: Calling openCoreConfig()
  - Then: Rejects with 'Failed to open core-config.yaml (code n)'
- Unit Test: `tests/services/config_service_test.ts::... read permission denied suggests flags`
  - Given: PermissionDenied on read
  - When: Calling openCoreConfig()
  - Then: Rejects with guidance to include --allow-read
- Unit Test: `tests/services/config_service_test.ts::... run permission denied suggests flags`
  - Given: PermissionDenied on run
  - When: Calling openCoreConfig()
  - Then: Rejects with guidance to include --allow-run

#### AC2: CLI --open-config invokes service, prints result, exits with correct code

Coverage: FULL

Given-When-Then Mappings:

- CLI Test: `tests/cli/config_cli_test.ts::CLI --open-config prints success and exits 0`
  - Given: Services factory with config.openCoreConfig() => { code: 0 }
  - When: Running mainAsync with `['--open-config']`
  - Then: Exit code 0; stdout includes 'Opened core-config.yaml'
- CLI Test: `tests/cli/config_cli_test.ts::CLI --open-config prints actionable error and exits 1 on failure`
  - Given: Services factory with config.openCoreConfig() rejecting with not-found error
  - When: Running mainAsync with `['--open-config']`
  - Then: Exit code 1; stdout includes actionable error

#### AC3: Centralized dependencies via deps.ts

Coverage: FULL (policy + code review)

Given-When-Then Mappings:

- Policy Test: `tests/policy/deps_policy_test.ts::Centralized deps policy: view/service import via deps.ts`
  - Given: Static import scan over selected view/service targets
  - When: Scanning for external/bare imports
  - Then: No violations detected (policy enforced project-wide)
- Code Review Evidence: `src/services/config_service.ts` imports `path` from 'deps'
  - Given: Service implementation
  - When: Checking imports
  - Then: External deps centralized

#### AC4: Tests added for service and CLI (success and failure scenarios)

Coverage: FULL

Given-When-Then Mappings:

- See mappings for AC1 and AC2 â€” tests exist and pass (26/26 suite-wide)

### Critical Gaps

None.

### Test Design References

- Test design matrix: qa.qaLocation/assessments/2.3-test-design-20250817.md

### Risk Assessment

- High Risk: 0
- Medium Risk: 0
- Low Risk: 0
